@model TafsilkPlatform.Models.ViewModels.ResetPasswordViewModel

@{
    ViewData["Title"] = "إعادة تعيين كلمة المرور - تفصيلك";
}

@section Styles {
  <style>
  .reset-password-page {
      background-color: var(--background-gray);
   min-height: calc(100vh - 200px);
            padding: var(--spacing-3xl) 0;
}

     .reset-container {
            max-width: 500px;
  margin: 0 auto;
   }

        .card {
        background: var(--background-white);
border: 1px solid var(--border-color);
    border-radius: var(--radius-xl);
  padding: var(--spacing-2xl);
            box-shadow: var(--shadow-lg);
     }

        .page-header {
        text-align: center;
            margin-bottom: var(--spacing-2xl);
      }

        .page-icon {
    font-size: 3rem;
color: var(--success-color);
     margin-bottom: var(--spacing-md);
        }

    .page-title {
            font-size: var(--font-size-3xl);
         font-weight: 700;
      color: var(--text-primary);
       margin-bottom: var(--spacing-sm);
  }

        .page-subtitle {
      color: var(--text-secondary);
            font-size: var(--font-size-base);
     }

        .form-group {
      margin-bottom: 1.25rem;
            position: relative;
  }

        .form-label {
         display: block;
      margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .form-control {
    width: 100%;
  padding: 0.875rem 1rem;
    border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
    font-size: 1rem;
 font-family: var(--font-family);
   transition: all 0.2s;
        }

        .form-control:focus {
  outline: none;
   border-color: var(--primary-color);
   box-shadow: 0 0 0 3px rgba(44, 90, 160, 0.1);
    }

        .password-input-group {
          position: relative;
        }

        .password-toggle-btn {
            position: absolute;
  left: 12px;
 top: 50%;
   transform: translateY(-50%);
    background: none;
      border: none;
  color: var(--text-secondary);
 cursor: pointer;
  padding: 4px;
         transition: color 0.2s;
        }

        .password-toggle-btn:hover {
          color: var(--primary-color);
      }

        .password-requirements {
     background: var(--background-light);
         padding: var(--spacing-md);
  border-radius: var(--radius-md);
    margin-bottom: var(--spacing-md);
        }

        .requirement-item {
    display: flex;
       align-items: center;
   gap: var(--spacing-sm);
    padding: 0.25rem 0;
     font-size: 0.9rem;
      color: var(--text-secondary);
      }

    .requirement-item i {
  font-size: 0.8rem;
        }

  .requirement-item.met {
         color: var(--success-color);
        }

        .requirement-item.met i {
        color: var(--success-color);
        }

        .btn-submit {
  width: 100%;
            padding: 0.875rem 1rem;
      background-color: var(--success-color);
            color: white;
    border: none;
       border-radius: var(--radius-md);
   font-size: 1rem;
          font-weight: 600;
 cursor: pointer;
            transition: all 0.2s;
         margin-top: var(--spacing-md);
  }

  .btn-submit:hover {
background-color: #28a745;
transform: translateY(-2px);
     box-shadow: var(--shadow-md);
        }

        .text-danger {
       color: var(--error-color);
        font-size: 0.85rem;
     margin-top: 0.25rem;
display: block;
   }

        .alert {
   padding: 1rem 1.25rem;
     margin-bottom: var(--spacing-lg);
            border-radius: var(--radius-md);
  }

        .alert-danger {
       background-color: #f8d7da;
       border: 1px solid #f5c6cb;
            color: #721c24;
   }

        @@media (max-width: 768px) {
            .reset-password-page {
  padding: var(--spacing-xl) var(--spacing-md);
  }

            .card {
            padding: var(--spacing-lg);
      }
      }
    </style>
}

<div class="reset-password-page">
<div class="container reset-container">
        <div class="card">
   <div class="page-header">
    <i class="fas fa-shield-alt page-icon"></i>
   <h1 class="page-title">إعادة تعيين كلمة المرور</h1>
      <p class="page-subtitle">أدخل كلمة المرور الجديدة الخاصة بك</p>
  </div>

            <form asp-action="ResetPassword" method="post">
  @Html.AntiForgeryToken()
        <input type="hidden" asp-for="Token" />
       <div asp-validation-summary="ModelOnly" class="alert alert-danger"></div>

    <div class="password-requirements">
  <div class="requirement-item" id="req-length">
  <i class="fas fa-circle"></i>
     <span>8 أحرف على الأقل</span>
   </div>
     <div class="requirement-item" id="req-uppercase">
             <i class="fas fa-circle"></i>
  <span>حرف كبير واحد على الأقل</span>
      </div>
            <div class="requirement-item" id="req-number">
              <i class="fas fa-circle"></i>
  <span>رقم واحد على الأقل</span>
</div>
        <div class="requirement-item" id="req-special">
              <i class="fas fa-circle"></i>
  <span>رمز خاص واحد على الأقل</span>
        </div>
</div>

 <div class="form-group">
      <label asp-for="NewPassword" class="form-label">كلمة المرور الجديدة</label>
     <div class="password-input-group">
    <input asp-for="NewPassword" 
        class="form-control" 
          type="password" 
    placeholder="أدخل كلمة المرور الجديدة"
   id="newPassword" />
          <button type="button" class="password-toggle-btn" data-target="newPassword">
     <i class="fas fa-eye"></i>
       </button>
  </div>
  <span asp-validation-for="NewPassword" class="text-danger"></span>
    </div>

    <div class="form-group">
     <label asp-for="ConfirmPassword" class="form-label">تأكيد كلمة المرور</label>
      <div class="password-input-group">
       <input asp-for="ConfirmPassword" 
          class="form-control" 
        type="password" 
    placeholder="أعد إدخال كلمة المرور"
            id="confirmPassword" />
      <button type="button" class="password-toggle-btn" data-target="confirmPassword">
  <i class="fas fa-eye"></i>
   </button>
          </div>
    <span asp-validation-for="ConfirmPassword" class="text-danger"></span>
     </div>

   <button type="submit" class="btn-submit">
  <i class="fas fa-check me-2"></i>
        إعادة تعيين كلمة المرور
     </button>
  </form>
  </div>
  </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    
    <script>
        document.addEventListener("DOMContentLoaded", function () {
       // Password visibility toggles
   document.querySelectorAll('.password-toggle-btn').forEach(btn => {
     btn.addEventListener('click', function () {
       const targetId = this.getAttribute('data-target');
  const input = document.getElementById(targetId);
      const icon = this.querySelector('i');

         if (input.type === 'password') {
  input.type = 'text';
  icon.classList.remove('fa-eye');
     icon.classList.add('fa-eye-slash');
  } else {
             input.type = 'password';
        icon.classList.remove('fa-eye-slash');
     icon.classList.add('fa-eye');
        }
       });
            });

    // Password requirements checker
      const newPasswordInput = document.getElementById('newPassword');

    if (newPasswordInput) {
        newPasswordInput.addEventListener('input', function () {
          const password = this.value;

        // Check length
         const lengthReq = document.getElementById('req-length');
    if (password.length >= 8) {
                lengthReq.classList.add('met');
                 lengthReq.querySelector('i').classList.remove('fa-circle');
      lengthReq.querySelector('i').classList.add('fa-check-circle');
      } else {
             lengthReq.classList.remove('met');
           lengthReq.querySelector('i').classList.remove('fa-check-circle');
  lengthReq.querySelector('i').classList.add('fa-circle');
        }

           // Check uppercase
       const uppercaseReq = document.getElementById('req-uppercase');
     if (/[A-Z]/.test(password)) {
        uppercaseReq.classList.add('met');
   uppercaseReq.querySelector('i').classList.remove('fa-circle');
      uppercaseReq.querySelector('i').classList.add('fa-check-circle');
              } else {
                uppercaseReq.classList.remove('met');
 uppercaseReq.querySelector('i').classList.remove('fa-check-circle');
uppercaseReq.querySelector('i').classList.add('fa-circle');
              }

       // Check number
        const numberReq = document.getElementById('req-number');
           if (/[0-9]/.test(password)) {
 numberReq.classList.add('met');
    numberReq.querySelector('i').classList.remove('fa-circle');
        numberReq.querySelector('i').classList.add('fa-check-circle');
     } else {
      numberReq.classList.remove('met');
            numberReq.querySelector('i').classList.remove('fa-check-circle');
              numberReq.querySelector('i').classList.add('fa-circle');
   }

     // Check special character
 const specialReq = document.getElementById('req-special');
    if (/[^A-Za-z0-9]/.test(password)) {
              specialReq.classList.add('met');
        specialReq.querySelector('i').classList.remove('fa-circle');
     specialReq.querySelector('i').classList.add('fa-check-circle');
           } else {
      specialReq.classList.remove('met');
 specialReq.querySelector('i').classList.remove('fa-check-circle');
            specialReq.querySelector('i').classList.add('fa-circle');
                    }
          });
            }
        });
    </script>
}
