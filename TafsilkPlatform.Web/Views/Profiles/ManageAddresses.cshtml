@model List<TafsilkPlatform.Web.Models.UserAddress>

@{
    ViewData["Title"] = "إدارة العناوين";
}

<div class="container py-5">
    <div class="row">
        <div class="col-lg-10 mx-auto">
 <!-- Header -->
            <div class="card border-0 shadow-sm mb-4">
     <div class="card-body bg-gradient-primary text-white p-4 rounded">
           <div class="d-flex justify-content-between align-items-center">
      <div>
      <h2 class="mb-2"><i class="fas fa-map-marker-alt me-2"></i>إدارة العناوين</h2>
   <p class="mb-0 opacity-75">قم بإضافة وتعديل عناوين التوصيل الخاصة بك</p>
         </div>
         <a asp-action="AddAddress" class="btn btn-light">
    <i class="fas fa-plus me-2"></i>إضافة عنوان جديد
   </a>
         </div>
      </div>
            </div>

        <!-- Success/Error Messages -->
         @if (TempData["Success"] != null)
            {
    <div class="alert alert-success alert-dismissible fade show">
      <i class="fas fa-check-circle me-2"></i>@TempData["Success"]
       <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
             </div>
     }
         @if (TempData["Error"] != null)
            {
         <div class="alert alert-danger alert-dismissible fade show">
<i class="fas fa-exclamation-circle me-2"></i>@TempData["Error"]
         <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
     </div>
            }

            @if (!Model.Any())
         {
           <!-- No Addresses State -->
     <div class="card border-0 shadow-sm text-center py-5">
 <div class="card-body">
             <i class="fas fa-map-marked-alt fa-4x text-muted mb-3"></i>
 <h4>لا توجد عناوين محفوظة</h4>
    <p class="text-muted">قم بإضافة عنوان التوصيل الخاص بك لإتمام الطلبات</p>
       <a asp-action="AddAddress" class="btn btn-primary">
     <i class="fas fa-plus me-2"></i>إضافة أول عنوان
         </a>
     </div>
        </div>
 }
  else
    {
   <!-- Address Cards -->
       <div class="row">
            @foreach (var address in Model)
  {
   <div class="col-md-6 mb-4">
         <div class="card h-100 border-0 shadow-sm @(address.IsDefault ? "border-primary border-2" : "")">
  <div class="card-body">
 <div class="d-flex justify-content-between align-items-start mb-3">
           <h5 class="card-title mb-0">
      <i class="fas fa-map-pin me-2 text-primary"></i>
       @address.Label
        </h5>
        @if (address.IsDefault)
      {
     <span class="badge bg-primary">عنوان افتراضي</span>
     }
      </div>

              <div class="address-details">
             <p class="mb-2">
   <i class="fas fa-road me-2 text-muted"></i>
 @address.Street
         </p>
         <p class="mb-2">
   <i class="fas fa-city me-2 text-muted"></i>
   @address.City
         </p>
    @if (address.Latitude.HasValue && address.Longitude.HasValue)
          {
         <p class="mb-0 text-muted small">
            <i class="fas fa-location-dot me-2"></i>
             @address.Latitude.Value.ToString("F6"), @address.Longitude.Value.ToString("F6")
     </p>
   }
          </div>

          <div class="d-flex gap-2 mt-3 pt-3 border-top">
           <a asp-action="EditAddress" asp-route-id="@address.Id" class="btn btn-sm btn-outline-primary flex-fill">
     <i class="fas fa-edit me-1"></i>تعديل
        </a>
      
       @if (!address.IsDefault)
          {
          <form asp-action="SetDefaultAddress" asp-route-id="@address.Id" method="post" class="flex-fill">
       @Html.AntiForgeryToken()
        <button type="submit" class="btn btn-sm btn-outline-success w-100">
       <i class="fas fa-star me-1"></i>جعله افتراضي
   </button>
 </form>
   }

          <form asp-action="DeleteAddress" asp-route-id="@address.Id" method="post" 
             onsubmit="return confirm('هل أنت متأكد من حذف هذا العنوان؟')">
   @Html.AntiForgeryToken()
<button type="submit" class="btn btn-sm btn-outline-danger">
            <i class="fas fa-trash me-1"></i>حذف
  </button>
   </form>
       </div>
  </div>
         </div>
       </div>
  }
                </div>
       }

            <!-- Back Button -->
            <div class="text-center mt-4">
       <a asp-action="CustomerProfile" class="btn btn-outline-secondary">
          <i class="fas fa-arrow-right me-2"></i>العودة للملف الشخصي
      </a>
 </div>
        </div>
    </div>
</div>

@section Styles {
 <style>
 .bg-gradient-primary {
   background: linear-gradient(135deg, #2c5aa0 0%, #1e3a5f 100%);
 }

        .card {
     transition: all 0.3s ease;
     }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1) !important;
        }
    </style>
}
