{
  "info": {
    "name": "Tafsilk Platform API",
    "_postman_id": "tafsilk-api-collection",
    "description": "Professional API collection for Tafsilk Platform - Complete tailoring and custom clothing marketplace.\n\nIncludes comprehensive authentication, user management, and service endpoints with detailed examples and automated testing.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
"key": "baseUrl",
      "value": "https://localhost:7186",
      "type": "string"
    },
    {
      "key": "token",
      "value": "",
      "type": "string"
    },
    {
      "key": "userId",
      "value": "",
      "type": "string"
    }
  ],
  "auth": {
    "type": "bearer",
    "bearer": [
      {
     "key": "token",
        "value": "{{token}}",
        "type": "string"
}
    ]
  },
  "item": [
    {
   "name": "Authentication",
"item": [
        {
 "name": "Register Customer",
          "event": [
 {
          "listen": "test",
       "script": {
           "exec": [
        "if (pm.response.code === 200) {",
      "    var jsonData = pm.response.json();",
     "    if (jsonData.userId) {",
"        pm.collectionVariables.set('userId', jsonData.userId);",
            "        pm.environment.set('userId', jsonData.userId);",
         "    }",
  "}",

                  "pm.test('Status code is 200', function () {",
       "    pm.response.to.have.status(200);",
           "});",
                  "",
          "pm.test('Response has success field', function () {",
       "    pm.expect(pm.response.json()).to.have.property('success');",
           "});"
    ]
         }
            }
    ],
 "request": {
            "auth": {
              "type": "noauth"
            },
   "method": "POST",
     "header": [
              {
           "key": "Content-Type",
         "value": "application/json"
           }
            ],
      "body": {
      "mode": "raw",
   "raw": "{\n  \"email\": \"test.customer@example.com\",\n  \"password\": \"SecurePass123!\",\n  \"fullName\": \"Test Customer\",\n  \"phoneNumber\": \"+1234567890\",\n  \"role\": 0\n}"
        },
            "url": {
   "raw": "{{baseUrl}}/api/auth/register",
   "host": ["{{baseUrl}}"],
      "path": ["api", "auth", "register"]
            },
          "description": "Creates a new customer account with email-based authentication.\n\n**Role Values:**\n- 0 = Customer (allowed via API)\n- 1 = Tailor (requires web-based registration with verification documents)\n\n**Validation:**\n- Email must be unique and valid format\n- Password minimum 6 characters\n- Full name is required\n- Phone number is optional but must be valid format if provided"
     },
          "response": [
      {
  "name": "Success",
           "originalRequest": {
         "method": "POST",
        "header": [],
       "body": {
         "mode": "raw",
  "raw": "{\n  \"email\": \"test.customer@example.com\",\n  \"password\": \"SecurePass123!\",\n  \"fullName\": \"Test Customer\",\n  \"phoneNumber\": \"+1234567890\",\n  \"role\": 0\n}"
    },
     "url": {
          "raw": "{{baseUrl}}/api/auth/register",
      "host": ["{{baseUrl}}"],
               "path": ["api", "auth", "register"]
              }
 },
           "status": "OK",
    "code": 200,
     "_postman_previewlanguage": "json",
     "header": [],
       "body": "{\n  \"success\": true,\n  \"message\": \"Account created successfully. Please login.\",\n  \"userId\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\"\n}"
     }
   ]
        },
     {
   "name": "Login",
          "event": [
       {
              "listen": "test",
  "script": {
        "exec": [
       "if (pm.response.code === 200) {",
     "    var jsonData = pm.response.json();",
 "    if (jsonData.token) {",
                  "pm.collectionVariables.set('token', jsonData.token);",
       " pm.environment.set('token', jsonData.token);",
         "   console.log('Token saved: ' + jsonData.token);",
           "    }",
       "  if (jsonData.user && jsonData.user.id) {",
      "        pm.collectionVariables.set('userId', jsonData.user.id);",
      "     pm.environment.set('userId', jsonData.user.id);",
        "    }",
         "}",

             "pm.test('Status code is 200', function () {",
     "    pm.response.to.have.status(200);",
      "});",
     "",
    "pm.test('Response has token', function () {
      "    pm.expect(pm.response.json()).to.have.property('token');",
               "});"
    ]
        }
      }
      ],
  "request": {
   "auth": {
        "type": "noauth"
            },
"method": "POST",
      "header": [
     {
             "key": "Content-Type",
         "value": "application/json"
}
      ],
   "body": {
            "mode": "raw",
  "raw": "{\n  \"email\": \"test.customer@example.com\",\n  \"password\": \"SecurePass123!\",\n  \"rememberMe\": false\n}"
     },
     "url": {
  "raw": "{{baseUrl}}/api/auth/login",
        "host": ["{{baseUrl}}"],
              "path": ["api", "auth", "login"]
      },
            "description": "Authenticates user credentials and returns JWT bearer token for API access.\n\n**Response Includes:**\n- JWT access token (60 minute expiration)\n- Token expiration timestamp\n- User profile summary\n\n**Token Usage:**\nInclude in subsequent requests: `Authorization: Bearer {token}`\n\n**Note:** Token is automatically saved to environment variables for use in other requests."
    },
          "response": [
   {
     "name": "Success",
   "originalRequest": {
            "method": "POST",
      "header": [],
  "body": {
  "mode": "raw",
         "raw": "{\n  \"email\": \"test.customer@example.com\",\n  \"password\": \"SecurePass123!\",\n  \"rememberMe\": false\n}"
            },
    "url": {
     "raw": "{{baseUrl}}/api/auth/login",
        "host": ["{{baseUrl}}"],
   "path": ["api", "auth", "login"]
 }
          },
   "status": "OK",
     "code": 200,
         "_postman_previewlanguage": "json",
   "header": [],
          "body": "{\n  \"success\": true,\n  \"message\": \"Login successful\",\n  \"token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n  \"expiresAt\": \"2025-01-03T12:00:00Z\",\n  \"user\": {\n    \"id\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\n    \"email\": \"test.customer@example.com\",\n    \"role\": \"Customer\",\n    \"isActive\": true\n  }\n}"
            }
    ]
        },
   {
          "name": "Get Current User",
        "request": {
        "method": "GET",
            "header": [],
            "url": {
        "raw": "{{baseUrl}}/api/auth/me",
  "host": ["{{baseUrl}}"],
              "path": ["api", "auth", "me"]
         },
            "description": "Retrieves comprehensive profile information for the authenticated user.\n\n**Authentication:** Requires valid JWT token in Authorization header\n\n**Response Includes:**\n- User identification and contact details\n- Account status and creation date\n- Role-specific profile data:\n  - Customer: Personal information and preferences\n  - Tailor: Business details, ratings, and verification status"
        },
       "response": [
      {
    "name": "Success - Customer",
           "originalRequest": {
 "method": "GET",
       "header": [],
     "url": {
      "raw": "{{baseUrl}}/api/auth/me",
           "host": ["{{baseUrl}}"],
      "path": ["api", "auth", "me"]
     }
    },
    "status": "OK",
       "code": 200,
         "_postman_previewlanguage": "json",
      "header": [],
   "body": "{\n  \"success\": true,\n  \"user\": {\n    \"id\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\n    \"email\": \"test.customer@example.com\",\n\"phoneNumber\": \"+1234567890\",\n \"role\": \"customer\",\n    \"isActive\": true,\n    \"createdAt\": \"2025-01-01T10:00:00Z\",\n    \"profile\": {\n  \"fullName\": \"Test Customer\",\n    \"city\": \"New York\",\n    \"gender\": \"Male\",\n      \"dateOfBirth\": \"1990-01-01T00:00:00Z\"\n    }\n  }\n}"
   }
          ]
        },
        {
          "name": "Logout",
          "request": {
            "method": "POST",
 "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/auth/logout",
     "host": ["{{baseUrl}}"],
              "path": ["api", "auth", "logout"]
 },
            "description": "Terminates the current user session.\n\n**Authentication:** Requires valid JWT token\n\n**Client Responsibilities:**\n- Remove token from local/session storage\n- Clear any cached user data\n- Redirect to login page if applicable\n\n**Note:** Token will naturally expire after its lifetime (60 minutes). Token blacklisting is planned for future implementation."
          },
          "response": [
      {
        "name": "Success",
            "originalRequest": {
       "method": "POST",
     "header": [],
    "url": {
            "raw": "{{baseUrl}}/api/auth/logout",
       "host": ["{{baseUrl}}"],
    "path": ["api", "auth", "logout"]
      }
      },
              "status": "OK",
        "code": 200,
              "_postman_previewlanguage": "json",
         "header": [],
     "body": "{\n  \"success\": true,\n  \"message\": \"Logout successful\"\n}"
        }
          ]
     },
 {
          "name": "Legacy Token Endpoint",
        "request": {
            "auth": {
              "type": "noauth"
      },
     "method": "POST",
     "header": [
    {
      "key": "Content-Type",
           "value": "application/json"
    }
            ],
     "body": {
         "mode": "raw",
              "raw": "{\n  \"email\": \"test.customer@example.com\",\n  \"password\": \"SecurePass123!\"\n}"
        },
   "url": {
        "raw": "{{baseUrl}}/api/auth/token",
        "host": ["{{baseUrl}}"],
            "path": ["api", "auth", "token"]
   },
            "description": "Simplified token generation endpoint for backward compatibility.\n\n**Returns:** JWT token string only (4 hour expiration)\n\n**Limitations:**\n- No account status validation\n- No user profile data in response\n- Minimal security checks\n\n**Recommendation:** Use /api/auth/login for new implementations, which provides enhanced security and comprehensive response data."
          },
  "response": [
            {
      "name": "Success",
      "originalRequest": {
    "method": "POST",
  "header": [],
      "body": {
         "mode": "raw",
              "raw": "{\n  \"email\": \"test.customer@example.com\",\n  \"password\": \"SecurePass123!\"\n}"
  },
       "url": {
   "raw": "{{baseUrl}}/api/auth/token",
   "host": ["{{baseUrl}}"],
          "path": ["api", "auth", "token"]
         }
         },
          "status": "OK",
  "code": 200,
          "_postman_previewlanguage": "json",
   "header": [],
              "body": "{\n  \"token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\"\n}"
         }
          ]
}
      ],
      "description": "Core authentication endpoints for user registration, login, and session management. Supports JWT bearer token authentication for secure API access."
    },
    {
      "name": "Testing Scenarios",
      "item": [
        {
          "name": "Register - Invalid Email",
      "request": {
       "auth": {
   "type": "noauth"
            },
   "method": "POST",
            "header": [
              {
    "key": "Content-Type",
          "value": "application/json"
      }
         ],
            "body": {
        "mode": "raw",
"raw": "{\n  \"email\": \"invalid-email\",\n  \"password\": \"SecurePass123!\",\n  \"fullName\": \"Test User\",\n  \"role\": 0\n}"
            },
            "url": {
   "raw": "{{baseUrl}}/api/auth/register",
       "host": ["{{baseUrl}}"],
    "path": ["api", "auth", "register"]
        },
    "description": "Validation test: Invalid email format\n\n**Expected Result:** 400 Bad Request with validation error message\n\n**Purpose:** Verifies email format validation is enforced"
          }
        },
   {
          "name": "Register - Weak Password",
      "request": {
            "auth": {
  "type": "noauth"
   },
"method": "POST",
          "header": [
    {
   "key": "Content-Type",
        "value": "application/json"
        }
            ],
    "body": {
              "mode": "raw",
   "raw": "{\n  \"email\": \"test@example.com\",\n  \"password\": \"123\",\n  \"fullName\": \"Test User\",\n  \"role\": 0\n}"
    },
       "url": {
   "raw": "{{baseUrl}}/api/auth/register",
              "host": ["{{baseUrl}}"],
          "path": ["api", "auth", "register"]
      },
          "description": "Validation test: Password below minimum length\n\n**Expected Result:** 400 Bad Request with password length validation error\n\n**Purpose:** Verifies password complexity requirements"
          }
      },
        {
      "name": "Register - Tailor via API",
          "request": {
        "auth": {
    "type": "noauth"
            },
      "method": "POST",
   "header": [
              {
       "key": "Content-Type",
  "value": "application/json"
      }
       ],
            "body": {
    "mode": "raw",
              "raw": "{\n  \"email\": \"tailor@example.com\",\n  \"password\": \"SecurePass123!\",\n  \"fullName\": \"Test Tailor\",\n\"shopName\": \"Elite Tailoring\",\n  \"city\": \"New York\",\n  \"role\": 1\n}"
    },
      "url": {
        "raw": "{{baseUrl}}/api/auth/register",
      "host": ["{{baseUrl}}"],
     "path": ["api", "auth", "register"]
     },
         "description": "Business rule test: Tailor registration blocked via API\n\n**Expected Result:** 400 Bad Request with message directing to web registration\n\n**Purpose:** Verifies tailor accounts must be created through web interface for document verification"
          }
        },
        {
          "name": "Login - Invalid Credentials",
    "request": {
    "auth": {
  "type": "noauth"
    },
       "method": "POST",
            "header": [
        {
      "key": "Content-Type",
       "value": "application/json"
              }
  ],
     "body": {
              "mode": "raw",
          "raw": "{\n  \"email\": \"test@example.com\",\n  \"password\": \"WrongPassword\",\n  \"rememberMe\": false\n}"
    },
      "url": {
     "raw": "{{baseUrl}}/api/auth/login",
              "host": ["{{baseUrl}}"],
   "path": ["api", "auth", "login"]
       },
            "description": "Security test: Invalid password authentication\n\n**Expected Result:** 401 Unauthorized\n\n**Purpose:** Verifies password verification and failed authentication handling"
          }
        },
     {
          "name": "Get User - No Token",
          "request": {
         "auth": {
       "type": "noauth"
    },
          "method": "GET",
     "header": [],
            "url": {
           "raw": "{{baseUrl}}/api/auth/me",
         "host": ["{{baseUrl}}"],
       "path": ["api", "auth", "me"]
            },
            "description": "Authorization test: Protected endpoint without authentication\n\n**Expected Result:** 401 Unauthorized\n\n**Purpose:** Verifies protected endpoints require valid JWT token"
          }
        }
      ],
      "description": "Comprehensive test scenarios covering validation rules, business logic enforcement, security measures, and error handling. Use these to verify API behavior under various conditions."
    }
  ]
}
